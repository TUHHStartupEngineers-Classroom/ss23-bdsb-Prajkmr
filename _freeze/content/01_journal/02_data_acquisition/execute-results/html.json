{
  "hash": "0089cc0c8893e485cf553d2d4b524d3b",
  "result": {
    "markdown": "---\ntitle: \"Data Acquisition\"\nauthor: \"Prajwal Kumar,Koretagere Vijay Kumar\"\n---\n\n# Challenge: \n## Get some data via an API.\nThere exists an api provider <https://anyapi.io/> for several features,\nIn my case, This API returns the latest currency conversion from one base currency to another. Here the base currency is EUR, To/converting currency is INR. Option to enter the amount/unit (in base currency) is given too.\n\nChange the API request params (base, to & amount) in the api request to check for other popular currencies, for example: Try for USD to EUR.\n\n*Code below*\n\n```\nlibrary(jsonlite)\ntoken <- \"hafkonmbi2gq2jta8s6jo8551pppnma5gamas1kh6r84pubbep7um8\"\ncurr <- GET(glue(\"https://anyapi.io/api/vl/exchange/convert?base=EUR&to=INR&amount=10&apiKey={token}\"))\ncurr_list<- fromJSON(rawToChar(curr$content))\ncurr_list\n```\n\n\n![Results for challenge 1](../../assets/img/data acquisition_1.png){fig-align=\"center\"}\n\n* Observation\n    + We can notice that the Base currency is \"EUR\", the conversion currency is \"INR\" & the amount is \"10\"Euros.\n* Output\n    + The API returns the converted value (903.31 INR) and also the rate of conversion (1 EUR= 90.331 INR in the above case).\n\n# Challenge: \n## Scrape one of the competitor websites of canyon\n\n\n::: {.cell hash='02_data_acquisition_cache/html/unnamed-chunk-1_1cc9b336ca4d6207303668e2d3232798'}\n\n```{.r .cell-code}\nlibrary(RSQLite)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ dplyr     1.1.1     ✔ readr     2.1.4\n#> ✔ forcats   1.0.0     ✔ stringr   1.5.0\n#> ✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n#> ✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n#> ✔ purrr     1.0.1     \n#> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#> ✖ dplyr::filter() masks stats::filter()\n#> ✖ dplyr::lag()    masks stats::lag()\n#> ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(httr)\nlibrary(glue)\nlibrary(jsonlite)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attaching package: 'jsonlite'\n#> \n#> The following object is masked from 'package:purrr':\n#> \n#>     flatten\n```\n:::\n\n```{.r .cell-code}\nlibrary(rvest)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attaching package: 'rvest'\n#> \n#> The following object is masked from 'package:readr':\n#> \n#>     guess_encoding\n```\n:::\n\n```{.r .cell-code}\nlibrary(stringi)\nlibrary(xopen)\nlibrary(dplyr)\nbase_url <- 'https://www.rosebikes.com/bikes'\n# 1. Function to get bike family URLs.\nget_bike_family_urls <- function(base_url) {\n  \n  bike_family_urls <- read_html(base_url) %>%\n    html_nodes(css = \".catalog-categories-item > a\") %>%\n    html_attr('href') %>%\n    \n    # Convert vector to tibble\n    \n    enframe(name = \"position\", value = \"subdirectory\") %>%\n    # Add the domain because we will get only the subdirectories\n    mutate(\n      url = glue('https://www.rosebikes.com{subdirectory}')\n    ) \n  \n  bike_family_urls <- bike_family_urls %>% \n    filter(!grepl('sale', url)) %>%\n    filter(!grepl('kids', url))\n  bike_family_urls <- bike_family_urls['url']\n  \n}\n# 2. Function to get bike family URLs.\nget_model_urls <- function(url) {\n  \n  bike_type_url <- read_html(url) %>%\n    html_nodes(css = \".catalog-category-bikes__content > a\") %>%\n    html_attr('href') %>%\n    enframe(name = \"position\", value = \"url\") %>%\n    mutate(url = glue('https://www.rosebikes.com{url}')) \n}\n# 3. Function to get the names of each bike \nget_bike_names <- function(url) {\n  \n  bike_model_name_tbl <- read_html(url) %>%\n    html_nodes(css = \".catalog-category-model__title\") %>%\n    html_text() %>%\n    # Convert vector to tibble\n    as_tibble()\n  \n  \n}\n# 4. Function to get the prices of each bike \nget_bike_prices <- function(url) {\n  \n  bike_model_price_tbl <- read_html(url) %>%\n    html_nodes(css = \".product-tile-price__current-value\") %>%\n    html_text() %>%\n    # Convert vector to tibble\n    as_tibble()\n  \n}\n#### APPLYING ABOVE FUNCTIONS\nbike_family_url_tbl <- get_bike_family_urls(base_url)\nbike_family_url_tbl <- bike_family_url_tbl %>%\n  slice(1:3) # Pick 3 categories\n# Create a table with bike model URLS\nbike_model_url_tbl <- tibble()\nfor (i in seq_along(bike_family_url_tbl$url)) {\n  \n  web <- toString(bike_family_url_tbl$url[i])\n  bike_model_url_tbl <- bind_rows(bike_model_url_tbl, get_model_urls(web))\n  \n}\n# Create a table with bike model names\nbike_model_names_tbl <- tibble()\nfor (i in seq_along(bike_model_url_tbl$url)) {\n  \n  web <- toString(bike_model_url_tbl$url[i])\n  bike_model_names_tbl <- bind_rows(bike_model_names_tbl, get_bike_names(web))\n  \n}\n# Rename cols\nnames(bike_model_names_tbl)[1] <- \"Bike Model\"\n# Create a table with bike prices\nbike_model_prices_tbl <- tibble()\nfor (i in seq_along(bike_model_url_tbl$url)) {\n  web <- toString(bike_model_url_tbl$url[i])\n  bike_model_prices_tbl <- bind_rows(bike_model_prices_tbl, get_bike_prices(web))\n}\n# Rename cols\nnames(bike_model_prices_tbl)[1] <- \"Bike Prices\"\n# Join into one table\ntable_of_prices <- bind_cols(bike_model_names_tbl,bike_model_prices_tbl)\nknitr::kable(table_of_prices[1:10, ], caption = 'Rosebike.com bicycle prices')\n```\n\n::: {.cell-output-display}\nTable: Rosebike.com bicycle prices\n\n|Bike Model    |Bike Prices |\n|:-------------|:-----------|\n|COUNT SOLO 1  |€749.00     |\n|COUNT SOLO 2  |€849.00     |\n|COUNT SOLO 3  |€949.00     |\n|PSYCHO PATH 1 |€1,499.00   |\n|PSYCHO PATH 2 |€1,799.00   |\n|THRILL HILL 4 |€5,499.00   |\n|THRILL HILL 5 |€6,699.00   |\n|THRILL HILL 1 |€2,999.00   |\n|THRILL HILL 2 |€3,399.00   |\n|THRILL HILL 3 |€3,999.00   |\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}